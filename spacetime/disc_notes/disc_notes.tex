\documentclass[12pt]{article}

\usepackage[numbers]{natbib}
\bibliographystyle{apalike}

\usepackage[a4paper,
 total={170mm,257mm},
 left=20mm,
 top=20mm,
 bottom=20mm,
 right=20mm]{geometry}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{amssymb}
\usepackage[colorlinks, citecolor = blue, linkcolor = blue, urlcolor = blue]{hyperref}
\usepackage{amsmath}


\title{Re: AIR for hyperbolics...}

% To make the stencils look a little nicer.
\renewcommand\arraystretch{1.35}


\begin{document}
\maketitle



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
\section{Finite difference discretizations of wave equation }
Various discretizations for the second-order wave equation in 1D,
\begin{align}
\frac{\partial^2 u}{\partial t^2} = c^2 \frac{\partial^2 u}{\partial x^2},
\end{align}
and in 2D,
\begin{align}
\frac{\partial^2 u}{\partial t^2} = c_x^2 \frac{\partial^2 u}{\partial x^2} + c_y^2 \frac{\partial^2 u}{\partial y^2}.
\end{align}
%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{UW1a-1D}
Define $\lambda \equiv c \tfrac{\Delta t}{h_x}$.
From \cite[eqn. (7) \& (8)]{Banks2012}, have
\begin{align}
u_{i}^{n+1} &= 
\begin{bmatrix}
\tfrac{1}{8} (4 \lambda^2 + 1) \\
\tfrac{1}{4}(3 - 4 \lambda^2)  \\
\tfrac{1}{8} (4 \lambda^2 + 1) 
\end{bmatrix}^\top
\begin{bmatrix}
u_{i-1} \\
u_i  \\
u_{i+1} 
\end{bmatrix}^n 
+
\begin{bmatrix}
\tfrac{\lambda \Delta t}{4} \\
\tfrac{\Delta t}{2}(2 - \lambda) \\
\tfrac{\lambda \Delta t}{4} 
\end{bmatrix}^\top
\begin{bmatrix}
v_{i-1} \\
v_i  \\
v_{i+1} 
\end{bmatrix}^n 
\\
v_{i}^{n+1} &= 
\begin{bmatrix}
\tfrac{\lambda^2}{\Delta t} \\
- \tfrac{2 \lambda^2}{\Delta t} \\ 
\tfrac{\lambda^2}{\Delta t}  
\end{bmatrix}^\top
\begin{bmatrix}
u_{i-1} \\
u_i  \\
u_{i+1} 
\end{bmatrix}^n 
+
\begin{bmatrix}
\tfrac{\lambda}{2} \\
1 - \lambda \\
\tfrac{\lambda}{2} 
\end{bmatrix}^\top
\begin{bmatrix}
v_{i-1} \\
v_i  \\
v_{i+1} 
\end{bmatrix}^n 
\end{align}
Stability condition is
\begin{align}
\Delta t \leq \frac{1 + \sqrt{5}}{4} \frac{h_x}{c} \approx 0.809 \frac{h_x}{c}
\end{align}
But I don't understand this... They give this stability condition in the sentence where they introduce the scheme as $\Delta t \leq h_x/(2c )$, but then in the paragraph following it they say the scheme is stable if $\Delta t \leq (1 + \sqrt{5})/4 h_x /c \approx 0.809 h_x /c$... Maybe in this first instance they're not saying that's the stability of the scheme, but that's the part of the domain where the scheme applies or something.
%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{UW1-1D}
Define $\lambda \equiv c \tfrac{\Delta t}{h_x}$.
From \cite[eqn. (48) \& (47)]{Banks2012}, have
\begin{align}
u_{i}^{n+1} &= 
\begin{bmatrix}
\tfrac{1}{2} \lambda^2 \\
1 - \lambda^2 \\
\tfrac{1}{2} \lambda^2 
\end{bmatrix}^\top
\begin{bmatrix}
u_{i-1} \\
u_i  \\
u_{i+1} 
\end{bmatrix}^n 
\quad 
+ 
\quad
\begin{bmatrix}
\tfrac{\lambda \Delta t}{4} \\
\tfrac{\Delta t}{2}(2 - \lambda) \\
\tfrac{\lambda \Delta t}{4} 
\end{bmatrix}^\top
\begin{bmatrix}
v_{i-1} \\
v_{i} \\
v_{i+1}  
\end{bmatrix}^n
\\
v_{i}^{n+1} &= 
\begin{bmatrix}
\tfrac{\lambda^2}{\Delta t} \\
- \tfrac{2 \lambda^2}{\Delta t} \\ 
\tfrac{\lambda^2}{\Delta t} 
\end{bmatrix}^\top
\begin{bmatrix}
u_{i-1} \\
u_{i} \\
u_{i+1}
\end{bmatrix}^n 
\quad 
+ 
\quad
\begin{bmatrix}
\tfrac{\lambda}{2} \\
1 - \lambda \\
\tfrac{\lambda }{2} 
\end{bmatrix}^\top
\begin{bmatrix}
v_{i-1} \\
v_{i}  \\
v_{i+1}  
\end{bmatrix}^n
\end{align}
Stability condition is
\begin{align}
\Delta t \leq \frac{h_x}{c}.
\end{align}
Note that it's only the $u^{n+1}$ to $u^n$ connections (and the resulting CFL limit) that distinguish this scheme from UW1a-1D.

%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{UW2-1D}
Define $\lambda \equiv c \tfrac{\Delta t}{h_x}$.
The stencil \cite[eq. (57) \& (56)]{Banks2012} is given by
\begin{align}
u_{i}^{n+1} 
&= 
u_{i} ^n  + \Delta t v_{i}^n +  \tfrac{\Delta t}{2} g_{i} ^n,
\\
v_{i}^{n+1} 
&= 
v_{i} ^n + g_{i}^n,
\end{align}
where we have the intermediate quantity
\begin{align}
g_{i}^{n} 
&= 
\begin{bmatrix}
\tfrac{\lambda^3}{4 \Delta t} \\
\tfrac{\lambda^2}{\Delta t} (1 - \lambda) \\ 
- \tfrac{\lambda^2}{2 \Delta t} (4 - 3 \lambda) \\
\tfrac{\lambda^2}{\Delta t} (1 - \lambda) \\
\tfrac{\lambda^3}{4 \Delta t} 
\end{bmatrix}^\top
\begin{bmatrix}
u_{i-2} \\
u_{i-1} \\
u_i  \\
u_{i+1} \\
u_{i+2}
\end{bmatrix}^n 
\quad 
+ 
\quad
\begin{bmatrix}
-\tfrac{\lambda}{8} \\
\tfrac{\lambda}{2} (1 + \lambda) \\ 
-\tfrac{\lambda}{4} (3 +4 \lambda) \\ 
\tfrac{\lambda}{2} (1 + \lambda) \\
-\tfrac{\lambda}{8} 
\end{bmatrix}^\top
\begin{bmatrix}
v_{i-2} \\
v_{i-1} \\
v_i  \\
v_{i+1} \\
v_{i+2}
\end{bmatrix}^n 
\end{align}
Stability condition is \cite[eq. (63)]{Banks2012}
\begin{align}
\Delta t \leq  \frac{h_x \Lambda_2}{c}, \quad \Lambda_2 =  \frac{\sqrt{5} - 1}{2} \approx 0.618034 .
\end{align}
%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{UW4-1D}
Define $\lambda \equiv c \tfrac{\Delta t}{h_x}$.
The stencil \cite[eqn. (74), (73), \& app. A.1]{Banks2012} is given by
\begin{align}
u_{i}^{n+1} &= 
\begin{aligned}
&
\begin{bmatrix}
-\tfrac{\lambda^3}{432}(9 -2 \lambda^2) \\
-\tfrac{\lambda^2}{72} (3 - 9 \lambda - 3 \lambda^2 + 2 \lambda^3) \\
\tfrac{\lambda^2}{144} (96 - 45 \lambda - 24 \lambda^2 + 10 \lambda^3) \\
\tfrac{1}{108} (108 - 135 \lambda^2 +45 \lambda^3 + 27 \lambda^4 -10 \lambda^5) \\  
\tfrac{\lambda^2}{144} (96 - 45 \lambda - 24 \lambda^2 + 10 \lambda^3) \\
-\tfrac{\lambda^2}{72} (3 - 9 \lambda - 3 \lambda^2 + 2 \lambda^3) \\
-\tfrac{\lambda^3}{432}(9 -2 \lambda^2)
\end{bmatrix}^\top
\begin{bmatrix}
u_{i-3} \\
u_{i-2} \\
u_{i-1} \\
u_i  \\
u_{i+1} \\
u_{i+2} \\
u_{i+3}
\end{bmatrix}^n 
\\
&\quad \quad \quad \quad \quad+ 
\begin{bmatrix}
\tfrac{\Delta t \lambda}{576}(5 - 4 \lambda^2) \\
-\tfrac{\Delta t \lambda}{864} (45 + 12 \lambda - 36 \lambda^2 - 8 \lambda^3) \\
\tfrac{\Delta t \lambda}{1728} (225 + 384 \lambda - 180 \lambda^2 - 64 \lambda^3) \\
\tfrac{\Delta t }{144} (144 - 25 \lambda - 60 \lambda^2 + 20 \lambda^3 + 8  \lambda^4) \\  
\tfrac{\Delta t \lambda}{1728} (225 + 384 \lambda - 180 \lambda^2 - 64 \lambda^3) \\
-\tfrac{\Delta t \lambda}{864} (45 + 12 \lambda - 36 \lambda^2 - 8 \lambda^3) \\
\tfrac{\Delta t \lambda}{576}(5 - 4 \lambda^2) \\
\end{bmatrix}^\top
\begin{bmatrix}
v_{i-3} \\
v_{i-2} \\
v_{i-1} \\
v_i  \\
v_{i+1} \\
v_{i+2} \\
v_{i+3}
\end{bmatrix}^n.
\end{aligned}
\\
v_{i}^{n+1} &= 
\begin{bmatrix}
-\tfrac{\lambda^3}{48 \Delta t}(3 - \lambda^2) \\
-\tfrac{\lambda^2}{24 \Delta t} (2 - 9 \lambda - 4 \lambda^2 + 3 \lambda^3) \\
\tfrac{\lambda^2}{48 \Delta t} (64 - 45 \lambda - 32 \lambda^2 + 15 \lambda^3) \\
-\tfrac{\lambda^2}{12 \Delta t} (30 - 15 \lambda - 12 \lambda^2 + 5 \lambda^3) \\  
\tfrac{\lambda^2}{48 \Delta t} (64 - 45 \lambda - 32 \lambda^2 + 15 \lambda^3) \\
-\tfrac{\lambda^2}{24 \Delta t} (2 - 9 \lambda - 4 \lambda^2 + 3 \lambda^3) \\
-\tfrac{\lambda^3}{48}(3 - \lambda^2)
\end{bmatrix}^\top
\begin{bmatrix}
u_{i-3} \\
u_{i-2} \\
u_{i-1} \\
u_i  \\
u_{i+1} \\
u_{i+2} \\
u_{i+3}
\end{bmatrix}^n 
+
\begin{bmatrix}
\tfrac{\lambda}{288}(5 - 8 \lambda^2) \\
-\tfrac{\lambda}{48} (5 + 2 \lambda - 8 \lambda^2 - 2 \lambda^3) \\
\tfrac{\lambda}{96} (25 + 64 \lambda - 40 \lambda^2 - 16 \lambda^3) \\
\tfrac{1}{72} (72 - 25 \lambda - 90 \lambda^2 + 40 \lambda^3 + 18  \lambda^4) \\  
\tfrac{\lambda}{96} (25 + 64 \lambda - 40 \lambda^2 - 16 \lambda^3) \\
-\tfrac{\lambda}{48} (5 + 2 \lambda - 8 \lambda^2 - 2 \lambda^3) \\
\tfrac{\lambda}{288}(5 - 8 \lambda^2) 
\end{bmatrix}^\top
\begin{bmatrix}
v_{i-3} \\
v_{i-2} \\
v_{i-1} \\
v_i  \\
v_{i+1} \\
v_{i+2} \\
v_{i+3}
\end{bmatrix}^n. 
\end{align}
Stability condition is \cite[lemma 3.5]{Banks2012}
\begin{align}
\Delta t \leq  \frac{h_x \Lambda_4}{c}, \quad \Lambda_4 \approx  1.09.
\end{align}
%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{UW1-2D}
Define $\lambda_x \equiv c_x \tfrac{\Delta t}{h_x}$, and $\lambda_y \equiv c_y \tfrac{\Delta t}{h_y}$. The stencil \cite[eq. (98)--(99)]{Banks2012} is given by
\begin{align}
u_{i,j}^{n+1} 
&= 
u_{i,j} ^n  + \Delta t v_{i,j}^n +  \tfrac{\Delta t}{2} g_{i,j} ^n,
\\
v_{i,j}^{n+1} 
&= 
v_{i,j} ^n + g_{i,j}^n,
\end{align}
where we have the intermediate quantity
\begin{align}
g_{i,j}^{n} &= 
\begin{bmatrix}
\tfrac{\lambda_y^2}{\Delta t} \\
\tfrac{\lambda_x^2}{\Delta t} \\
- \tfrac{2}{\Delta t}( \lambda_x^2 + \lambda_y^2) \\  
\tfrac{\lambda_x^2}{\Delta t} \\
\tfrac{\lambda_y^2}{\Delta t} \\
\end{bmatrix}^\top
\begin{bmatrix}
u_{i,j-1} \\
u_{i-1,j} \\
u_{i,j}  \\
u_{i+1,j} \\
u_{i,j+1}
\end{bmatrix}^n 
\quad 
+ 
\quad
\begin{bmatrix}
\tfrac{\lambda_y}{2} \\
\tfrac{\lambda_x}{2} \\
-(\lambda_x + \lambda_y) \\  
\tfrac{\lambda_x}{2} \\
\tfrac{\lambda_y}{2}
\end{bmatrix}^\top
\begin{bmatrix}
v_{i,j-1} \\
v_{i-1,j} \\
v_{i,j}  \\
v_{i+1,j} \\
v_{i,j+1}
\end{bmatrix}^n .
\end{align}
Stability condition is \cite[eq. (101)]{Banks2012}
\begin{align}
\Delta t \leq \left[ \frac{c_x}{h_x} +  \frac{c_y}{h_y}  \right]^{-1}.
\end{align}
%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{UW2-2D}
Define $\lambda_x \equiv c_x \tfrac{\Delta t}{h_x}$, and $\lambda_y \equiv c_y \tfrac{\Delta t}{h_y}$. The stencil \cite[eq. (103)--(106)]{Banks2012} is given by
\begin{align}
u_{i,j}^{n+1} 
&= 
u_{i,j} ^n  + \Delta t v_{i,j}^n +  \tfrac{\Delta t}{2} g_{i,j} ^n,
\\
v_{i,j}^{n+1} 
&= 
v_{i,j} ^n + g_{i,j}^n,
\end{align}
where we have the intermediate quantity
\begin{align}
\begin{aligned}
g_{i,j}^{n} &= 
\begin{bmatrix}
\tfrac{\lambda_y^3}{4 \Delta t} \\
\tfrac{\lambda_x \lambda_y}{4 \Delta t}(\lambda_x + \lambda_y) \\  
\tfrac{\lambda_y}{2 \Delta t}[ -\lambda_x(\lambda_x + \lambda_y)  + 2 \lambda_y(1 - \lambda_y)] \\
\tfrac{\lambda_x \lambda_y}{4 \Delta t}(\lambda_x + \lambda_y) \\ 
\tfrac{\lambda_x^3}{4 \Delta t} \\ 
\tfrac{\lambda_x}{2 \Delta t}[ -\lambda_y(\lambda_x + \lambda_y)  + 2 \lambda_x(1 - \lambda_x)] \\
-\tfrac{\lambda_x^2}{2 \Delta t}( 4 - 3 \lambda_x ) 
+\tfrac{\lambda_x \lambda_y}{\Delta t}(\lambda_x + \lambda_y) 
-\tfrac{\lambda_y^2}{2 \Delta t}( 4 - 3 \lambda_y ) \\  
\tfrac{\lambda_x}{2 \Delta t}[ -\lambda_y(\lambda_x + \lambda_y)  + 2 \lambda_x(1 - \lambda_x)] \\
\tfrac{\lambda_x^3}{4 \Delta t} \\ 
\tfrac{\lambda_x \lambda_y}{4 \Delta t}(\lambda_x + \lambda_y) \\ 
\tfrac{\lambda_y}{2 \Delta t}[ -\lambda_x(\lambda_x + \lambda_y)  + 2 \lambda_y(1 - \lambda_y)] \\
\tfrac{\lambda_x \lambda_y}{4 \Delta t}(\lambda_x + \lambda_y) \\ 
\tfrac{\lambda_y^3}{4 \Delta t}  
\end{bmatrix}^\top
\begin{bmatrix}
u_{i,j-2} \\
u_{i-1,j-1} \\
u_{i,j-1} \\
u_{i+1,j-1} \\
u_{i-2,j} \\
u_{i-1,j} \\
u_{i,j} \\
u_{i+1,j} \\
u_{i+2,j} \\
u_{i-1,j+1} \\
u_{i,j+1} \\
u_{i+1,j+1} \\
u_{i,j+2} 
\end{bmatrix}^n 
\\
& \quad \quad + \quad
\begin{bmatrix}
-\tfrac{\lambda_y}{8} \\
\tfrac{\lambda_y}{2}(1 + \lambda_y) \\  
-\tfrac{\lambda_x}{8} \\
\tfrac{\lambda_x}{2}(1 + \lambda_x) \\
-\tfrac{\lambda_x}{4}(3 + 4 \lambda_x) - \tfrac{\lambda_y}{4}(3 + 4 \lambda_y) \\
\tfrac{\lambda_x}{2}(1 + \lambda_x) \\
-\tfrac{\lambda_x}{8} \\
\tfrac{\lambda_y}{2}(1 + \lambda_y) \\  
-\tfrac{\lambda_y}{8} 
\end{bmatrix}^\top
\begin{bmatrix}
v_{i,j-2} \\
v_{i,j-1} \\
v_{i-2,j} \\
v_{i-1,j} \\
v_{i,j} \\
v_{i+1,j} \\
v_{i+2,j} \\
v_{i,j+1} \\
v_{i,j+2} 
\end{bmatrix}^n 
\end{aligned}.
\end{align}
Note that this scheme is a bit different to all of the previous ones since there are less connections to $v^n$ compared with $u^n$. This is because there are high-order cross terms in $x$ and $y$ applied to $u^n$ that are not applied to $v^n$. In this case, there are $u^n_{xxyy}$ terms but no equivalent for $v^n$---this is why there are diagonal connections for $u^n$ but not $v^n$.

Stability condition is \cite[eq. (107)]{Banks2012}
\begin{align}
\Delta t \leq \frac{\tfrac{1}{2} (\tilde{c}_x + \tilde{c}_y)\left[ \sqrt{5 + \tfrac{2 \tilde{c}_x \tilde{c}_y}{(\tilde{c}_x + \tilde{c}_y)^2}} - 1 \right]}{\tilde{c}_x^2 + \tilde{c}_y^2}, \quad \textrm{where \,} \tilde{c}_k = c_k / h_k.
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%


\bibliography{general}



\end{document}